# Coordinated Vulnerability Disclosure (CVD)

EXPERIMENT BY IGDC-DHCW - DRAFT - WORK IN PROGRESS - REQUEST FOR COMMENTS

## Situation - Context and Problem Statement

The upcoming IGDC-DHCW emergency department module (EDM) and its exploratory authentication service (WAuth) are work in progress. Currently these don't seem to have a process for coordinated vulnerability disclosure (CVD), such as if/how any person could report a potential security vulnerability.

The purpose of this document is to open up discussion of a CVD process for the EDM and WAuth services. Then ideally to implement it for those services. Then ideally to extend the CVD to additional IGDC-DHCW services.

The existing guidance from NHS Wales info sec that Joel has found (thus far) doesn't seem to say anything about how people will do security disclosure.

## Background - Decision Drivers

When a security vulnerability is discovered in a service, it is important to coordinate the disclosure of that vulnerability to the service's users. This is to ensure that the vulnerability is fixed as soon as possible, and that the service's users are not exposed to any risk.

Many popular websites handle this by having a "security" notice on their web page footers, and also by publishing a security process such as how to report a bug, how to report a potential vulnerability, etc. These notices help service providers work better with the public (and internal staff) to handle security issues effectively.

A "Coordinated Vulnerability Disclosure" (CVD) is a process where security vulnerabilities are disclosed to the public only after the responsible parties (like vendors) have had sufficient time to address and mitigate the issue, ensuring a coordinated and timely approach to patching and remediation.

Background reading:

<https://english.ncsc.nl/publications/publications/2019/juni/01/coordinated-vulnerability-disclosure-the-guideline>

* [Coordinated Vulnerability Disclosure - The Guideline - By National Cyber Security Centre - The Netherlands](https://english.ncsc.nl/publications/publications/2019/juni/01/coordinated-vulnerability-disclosure-the-guideline)

* [Coordinated Vulnerability Disclosure - GitHub repo - By Joel](https://github.com/joelparkerhenderson/coordinated-vulnerability-disclosure)

* [Wikipedia: Coordinated_vulnerability_disclosure](https://en.wikipedia.org/wiki/Coordinated_vulnerability_disclosure)

* [NHS Wales Information Security Policy](https://phw.nhs.wales/about-us/policies-and-procedures/policies-and-procedures-documents/information-governance-information-management-and-technology-policies/information-security-policy-all-wales/)

* [NHS Wales Information Security Policy for Primary Care Service Provider](https://dhcw.nhs.wales/ig/ig-documents/ig-framework/all-wales-information-security-policy-for-primary-care-service-providers/)

* [NIST Cybersecurity Framework](https://en.wikipedia.org/wiki/NIST_Cybersecurity_Framework)

### GOV.UK National Cyber Security Centre

Links:

* [GOV.UK National Cyber Security Centre: vulnerability management reporting disclosure](https://www.ncsc.gov.uk/collection/vulnerability-management/reporting-disclosure)

* [GitHub.com/UKNCSC](https://github.com/ukncsc)

Joel has asked the NCSC for help and guidance via their typical web form, such as if/how to use NCSC CVD.

* Joel's first skim of NCSC doesn't turns up lots about generic disclosure, but nothing about specific CVD.

* Joel's first skim of NCSC shows everything is IMHO typical practices throughout industry, i.e. there's nothing notable or differentiating. Therefore it looks fine to align, reference, etc., in general.

* The NCSC process has a few areas that are anti-CVD, such as telling the person what to do, rather than respecting the person's perspective; Joel's guess is this is merely an outdated document, rather than a countermand policy. Joel has asked the NCSC to clarify and ideally to correct.

The NCSC recommendations that look to be most relevant and useful and best practice:

* Create a dedicated security email address for reporting vulnerabilities, using the format of <security@example.com>, and a confirmation auto-reply that can provide additional instructions.

* Create a website file `security.txt` in the root directory of the website, and in the subdirectory `.well-known`, that is public i.e. accessible at <https://example.com/security.txt> and <https://example.com/.well-known/security.txt>, that explains the organization security policy.

* Create a PGP key for the security email address, and publish it in the `security.txt` file.

Joel tested the NCSC recommendations with our closest peers on 2025-03-25 and these email addresses all have issues:

* Email to <security@nhs.uk> fails with this message: Relay access denied (in reply to RCPT TO command).

* Email to <security@wales.nhs.uk> does not provide any receipt confirmation e.g. additional instructions.

* Email to <security@ncsc.gov.uk> does not provide any receipt confirmation e.g. additional instructions.

Joel tested these links on 2025-03-25:

* NCSC:

  * <https://www.ncsc.gov.uk/.well-known/security.txt> → success and has a PGP key (which is great!)

  * <https://www.ncsc.gov.uk/security.txt> → 404

* NHS UK:

  * <https://www.nhs.uk/.well-known/security.txt> → found, but forces the reporter to sign up with HackerOne, which is a for-profit service, and a blocker, and a security risk, and a cross-border political problem.

  * <https://nhs.uk/security.txt> → 404

* NHS England:

  * <https://www.england.nhs.uk/security.txt> → found, but forces the reporter to sign up with HackerOne, which is a for-profit service, and also a de-anonymization risk.

* NHS Wales:

  * <https://wales.nhs.uk/security.txt> → 404

  * <https://wales.nhs.uk/.well-known/security.txt> → 404

  * <https://nhs.wales/security.txt> → failure due to no root record

  * <https://nhs.wales/.well-known/security.txt> → failure due to no root record

  * <https://www.nhs.wales/security.txt> → 404

  * <https://www.nhs.wales/.well-known/security.txt> → 404

* NHS Wales DHCW:

  * <https://dhcw.nhs.wales/security.txt> → 404

  * <https://dhcw.nhs.wales/.well-known/security.txt> → 404

* NHS Scotland:

  * <https://www.scot.nhs.uk/.well-known/security.txt> → Success. But no PGP key. But forces HackerOne.

* NSCNI:

  * <https://www.hscni.net/security.txt> → 404

  * <https://www.hscni.net/.well-known/security.txt> → 404

What the above testing clearly shows is that UK NHS Wales is currently not harmonizing with UK NCSC (nor NL NCSC) at all, and more broadly that NHS4 is not harmonizing completely with NCSC. We should aim to fix this, so that do do harmonize with UK NCSC and NL NCSC.

### NHS England & NHS Scotland

NHS England and NHS Scotland have security policies that are derived from UK NCSC as above. Joel's skim didn't turn up anything notable or differentiating.

However, there are multiple weaknesses as compared to NCSC:

* No PGP key in the file `security.txt`.

* Redirect to HackerOne, which is a for-profit service, and a blocker, and a security risk, and a cross-border political problem.

### PGP signing

Pretty Good Privacy (PGP) signing is an industry standard for secure email messaging.

For reference, a typical PGP signed message looks like this, and would/could be included in the file `security.txt` as well as anywhere else the organization wishes to publish secure email instructions.

```txt
-----BEGIN PGP SIGNED MESSAGE-----
Hash: SHA256

Canonical: https://example.com/.well-known/security.txt)
Contact: mailto:security@nexample.com
Preferred-Languages: en
Encryption: https://example.com/encryption/
Policy: https://example.com/security/
Expires: 2026-01-01T00:00:00.000Z
-----BEGIN PGP SIGNATURE-----

jqSLotcXiyEu7PY3GBFPrqEUfTdaqBwPFRiQoGHc8RJebdkTDkFQStb322md3M16
3XBYDO0ArQXGQMQWP1d8lZhdOmiguIvVfWUXemGu3sC6vg7b8RNmtyGcSFpIwStj
QReSG0XasD9a5yArYvdBMQGcKbN6U0QGNOoCPUs42qjq7X91Rm9MlU6MtGFztcBg
r4YWAzmnMbEexiTaSPSsf55QFnqxZLI7Ktw8sovfs7wi4b1rNYgu2WMAPS53TGAG
ujGVR8Xx99yyhE3vaBD1BsjJnoPPc1gYcRJK7cbdmxXPgDEZmZOQjoY1GpBeqEkX
GK3f6h3CtRgBxNEAZdSE4ZfXCdhOOf3D6uldGZaBveIruFtesY3BwmarAdbEr1mi
uESVHaRz0xj02CSQ4DZfbFoC2OyfgiZLMAxQ4j8NqCPscKTcqegJAHwoD4axdysE
0QnY8uI0asS3DOm7b6ZnhyY76YZiOQYIKvPLLhRQ2rq8My72IdaI3OGqvI3Q1ku2
jRJvM7V9l61MgFHemdz1RlF5jDQtQFVQN9TVunIA9gebxgLYexGh6sWxNHoPxkgv

-----END PGP SIGNATURE-----
```

## Assessment - Considered Options

Our #1 option is to involve the CISO team, and let them decide what to do. We're working on this now.

Our #2 option is to use the existing work by Joel, which he developed thanks to [Colin Percival](https://en.wikipedia.org/wiki/Colin_Percival) and multiple enterprise clients.

We hope to have a Welsh-first option, such as a Welsh-first email address e.g. <sediogelwch@gig.cymru>. Currently the internal ops team says this capability is a ways in the future.

We hope to have an English-second option, such as an English-second email address e.g. <security@wales.nhs.uk>. It's possible that our group already has this, because a probe email to that address didn't bounce back. TBD.

We hope to add more options here.

## Recommendation - Decision Outcome

TODO as we learn more.

### Consequences

TODO as we learn more.

* Good, because {positive consequence, e.g., improvement of one or more desired qualities, …}
* Bad, because {negative consequence, e.g., compromising one or more desired qualities, …}
* … <!-- numbers of consequences can vary -->

### Confirmation (Optional)

TODO as we learn more.

{Describe how the implementation of/compliance with the ADR can/will be confirmed.}

## Pros and Cons of the Options (Optional)

TODO as we learn more.

### {title of option 1}

<!-- This is an optional element. Feel free to remove. -->
{example | description | pointer to more information | …}

* Good, because {argument a}
* Good, because {argument b}
<!-- use "neutral" if the given argument weights neither for good nor bad -->
* Neutral, because {argument c}
* Bad, because {argument d}
* … <!-- numbers of pros and cons can vary -->

## More Information (Optional)

TODO as we learn more.

{You might want to provide additional evidence/confidence for the decision outcome here and/or document the team agreement on the decision and/or define when/how this decision the decision should be realised and if/when it should be re-visited. Links to other decisions and resources might appear here as well.}
